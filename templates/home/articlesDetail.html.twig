{% extends 'base.html.twig' %}

{% block title %}{{ articles.title }}{% endblock %}

{% block body %}
    <div class="container">
        <div class="article-detail">
            <img src="{{ '../articles/'~articles.image }}" alt="{{ articles.title }}">
            <h1>{{ articles.title }}</h1>
            <div>{{ articles.content|raw }}</div>
        </div>

        {% if app.user %}
            <div class="mt-5">
                <h3>Ajouter un commentaire</h3>

                {{ form_start(form) }}

                {{ form_widget(form.title, {'attr': {'class': 'form-control-comments', 'placeholder': 'Titre'}}) }}
                {{ form_widget(form.content, {'attr': {'class': 'form-control-comments mt-3', 'placeholder': 'Votre commentaire'}}) }}

                <button class="btn btn-primary mt-3">Publier</button>

                {{ form_end(form) }}
            </div>
        {% else %}
            <div class="alert alert-info mt-4">
                Vous devez être connecté pour commenter.
            </div>
        {% endif %}


        <div class="comments-section mt-5">
            <h2>Commentaires ({{ articles.comments|length }})</h2>

            {% if articles.comments|length > 0 %}
                {% for comment in articles.comments %}
                    <div class="commentary d-flex align-items-start mb-4 p-3 border rounded">
                        <div class="me-3">
                            <img class="rounded-circle comments-pics" src="https://www.centre-social-la-seyne.com/wp-content/uploads/2025/03/blank-profile-picture-973460_960_720.webp" alt="Photo de profil">
                        </div>
                        <div>
                            <h6 class="mb-1">
                                {{ comment.title }} - <span class="text-muted">par {{ comment.author }}</span>
                            </h6>
                            <p class="mb-0"> {{ comment.content }} </p>
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <p>Aucun commentaire pour le moment.</p>
            {% endif %}
        </div>
    </div>
{% endblock %}
